import oson
from cred import DIR_EXCEL
# from oson import *
import pandas as pd


# pip install xlwt
# pip install openpyxl

def writer():
    pre_data = oson.report_finance_realisation().get('result').get('rows')
    data = {i.get('row_number'): i for i in pre_data}

    matrix = []
    for row in pre_data:
        pro = list(row.values())
        if row.get('offer_id') == 'KRTP10':
            print(22222, *row.items(), sep='\n')

        pro += ['0' for _ in range(10)]
        matrix.append(tuple(pro))

        row_number = row.get('row_number')
        product_id = row.get('product_name')
        product_name = row.get('')
        offer_id = row.get('offer_id')
        barcode = row.get('barcode')
        price = row.get('price')
        commission_percent = row.get('commission_percent')
        price_sale = row.get('price_sale')
        diff_price_rub = price - price_sale
        diff_price_percent = int(diff_price_rub / (price / 100))
        sale_qty = row.get('sale_qty')
        sale_amount = row.get('sale_amount')
        sale_discount = row.get('sale_discount')
        sale_commission = row.get('sale_commission')

        sale_price_seller = row.get('sale_price_seller')
        sale_commission_percent = sale_commission / sale_price_seller * 100
        return_sale = row.get('return_sale')
        return_qty = row.get('return_qty')
        return_amount = row.get('return_amount')
        return_discount = row.get('return_discount')
        return_commission = row.get('return_commission')
        return_price_seller = row.get('return_price_seller')

        proxy = (
            row_number,
            offer_id,
            product_id,
            product_name,
            price,
            price_sale,
            commission_percent,
            diff_price_percent,
            diff_price_rub,
            sale_discount,
            sale_commission,
            sale_commission_percent.round(1),

            sale_price_seller,
            return_sale,
            return_qty,
            return_amount,
            return_discount,
            return_commission,
            return_price_seller
            )


    print(*row.keys(), sep=f" = row.get(''),\n")
    print(*row.keys(), sep=",\n")
    print(3333, len(matrix))

    path = DIR_EXCEL + '/super_file-1.xlsx'
    columns = ['No',
               'Артикул', 'Ozon SKU ID', 'Название', 'Цена до скидки, руб.',
               'цена для покупателя', 'Ваша цена', 'Скидка, %', 'Скидка, руб.',
               'Цена с учетом акции или стратегии, руб.',
               '% комиссии МП (вознаграждение) FBO',
               'комиссии МП (вознаграждение) FBO',
               'экваринг FBO', 'логистика FBO',
               'последняя миля FBO',
               'возврат или отмена FBO',

               '% комиссии МП (вознаграждение) FBS',
               'комиссии МП (вознаграждение) FBS',
               'экваринг FBS',
               'обработка отправления FBS',
               'логистика FBS',
               'последняя миля FBS',
               'возврат или отмена FBS',
               'хранение',
               'услуги, реклама',
               'СПП',
               'дата поступления товара',
               'кол-во на складе ozone',
               'кол-во на складе FBS']
    df = pd.DataFrame(matrix, columns=columns)
    # df = pd.DataFrame.from_dict(data, orient='index')
    df.to_excel(path, index=False)

    print(111, len(columns))


def reader(file):
    df = pd.read_excel(file)
    for row in df.values:
        print(*row, sep="', '")


# reader('api затрат на МП_v2-2.xlsx')
answer_oson = {"result": {
    "header": {"num": "6416860", "doc_date": "2024-03-31", "start_date": "2024-03-01", "stop_date": "2024-03-31",
               "contract_date": "2022-06-22", "contract_num": "\u0418\u0420-124012/22",
               "payer_name": "\u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u0420\u0435\u0448\u0435\u043d\u0438\u044f, \u041e\u041e\u041e",
               "payer_inn": "7704217370", "payer_kpp": "997750001",
               "rcv_name": "\u041e\u041e\u041e \"\u0410\u0420\u0422\u041e\u041b\u042c\"", "rcv_inn": "6234113064",
               "rcv_kpp": "623401001", "doc_amount": 224331.72, "vat_amount": 37388.62, "currency_code": "RUR"},
    "rows": [{"row_number": 1, "product_id": 319591351,
              "product_name": "ARTOL \u041f\u0435\u0440\u0447\u0430\u0442\u043a\u0438 \u0445\u043e\u0437\u044f\u0439\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435, 6 \u043f\u0430\u0440",
              "offer_id": "PERCH0002", "barcode": "OZN637219053", "price": 200, "commission_percent": 0.18,
              "price_sale": 196, "sale_qty": 1, "sale_amount": 196, "sale_discount": 0, "sale_commission": 32,
              "sale_price_seller": 164, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0},
             {"row_number": 2, "product_id": 490790445, "product_name": "\u0418\u043e 102-48 \u0438\u0441\u043f.00",
              "offer_id": "Io10248isp00", "barcode": "OZN936299971", "price": 379, "commission_percent": 0.165,
              "price_sale": 380, "sale_qty": 1, "sale_amount": 380, "sale_discount": 0, "sale_commission": 63.54,
              "sale_price_seller": 316.46, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 3, "product_id": 490790352,
                                                                  "product_name": "\u0418\u041e 102-43 \"\u041d\u0435\u0440\u0436\u0430\u0432\u0435\u0439\u043a\u0430\" \u0438\u0441\u043f.00",
                                                                  "offer_id": "Io10243isp00", "barcode": "OZN936299982",
                                                                  "price": 999, "commission_percent": 0.165,
                                                                  "price_sale": 913, "sale_qty": 2, "sale_amount": 1826,
                                                                  "sale_discount": 0, "sale_commission": 157.68,
                                                                  "sale_price_seller": 1668.32, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 4, "product_id": 490790436,
              "product_name": "\u0418\u043e 102-40 \u0438\u0441\u043f. \u04112\u041f (2) \u0422\u0415\u0420\u0420\u0410\u041a\u041e\u0422\u041e\u0412\u042b\u0419 \u043f\u043b\u0430\u0441\u0442\u043c\u0430\u0441\u0441\u043e\u0432\u044b\u0439 \u0440\u0443\u043a\u0430\u0432",
              "offer_id": "Io10240ispB2P2TerrakotPlastmRukav", "barcode": "OZN936300103", "price": 339,
              "commission_percent": 0.165, "price_sale": 334, "sale_qty": 1, "sale_amount": 334, "sale_discount": 0,
              "sale_commission": 50.94, "sale_price_seller": 283.06, "return_sale": 0, "return_qty": 0,
              "return_amount": 0, "return_discount": 0, "return_commission": 0, "return_price_seller": 0},
             {"row_number": 5, "product_id": 490779253,
              "product_name": "\u0418\u041e 102-50 \u0438\u0441\u043f. \u04112\u041f (2) \u043f\u043b\u0430\u0441\u0442\u043c\u0430\u0441\u0441\u043e\u0432\u044b\u0439 \u0440\u0443\u043a\u0430\u0432",
              "offer_id": "IO10250ispB2PplastmRukav", "barcode": "OZN937590817", "price": 330,
              "commission_percent": 0.165, "price_sale": 330, "sale_qty": 2, "sale_amount": 660, "sale_discount": 0,
              "sale_commission": 108.9, "sale_price_seller": 551.1, "return_sale": 0, "return_qty": 0,
              "return_amount": 0, "return_discount": 0, "return_commission": 0, "return_price_seller": 0},
             {"row_number": 6, "product_id": 490779248,
              "product_name": "\u041e\u043a\u0442\u0430\u0432\u0430-12\u0412 \u0438\u0441\u043f.2",
              "offer_id": "567890", "barcode": "OZN937591415", "price": 859, "commission_percent": 0.165,
              "price_sale": 781, "sale_qty": 1, "sale_amount": 781, "sale_discount": 0, "sale_commission": 63.74,
              "sale_price_seller": 717.26, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 7, "product_id": 493042646,
                                                                  "product_name": "\u0418\u041f 103-10-\u04101 (\u0431\u0435\u0437 \u0418\u0412\u0421)",
                                                                  "offer_id": "izveshateli10310A1",
                                                                  "barcode": "OZN937781364", "price": 599,
                                                                  "commission_percent": 0.165, "price_sale": 573,
                                                                  "sale_qty": 12, "sale_amount": 6876,
                                                                  "sale_discount": 0, "sale_commission": 874.08,
                                                                  "sale_price_seller": 6001.92, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 8, "product_id": 493037651,
              "product_name": "\u0413\u0440\u0430\u043d\u0434 \u041c\u0430\u0433\u0438\u0441\u0442\u0440 \u0421\u0411 30 \u0432\u0435\u0440\u0441\u0438\u044f 2",
              "offer_id": "GrandMagistrSB30vers2", "barcode": "OZN937854298", "price": 6469,
              "commission_percent": 0.165, "price_sale": 5482, "sale_qty": 1, "sale_amount": 5482, "sale_discount": 0,
              "sale_commission": 80.39, "sale_price_seller": 5401.61, "return_sale": 0, "return_qty": 0,
              "return_amount": 0, "return_discount": 0, "return_commission": 0, "return_price_seller": 0},
             {"row_number": 9, "product_id": 493037623,
              "product_name": "\u041e\u043a\u0442\u0430\u0432\u0430-12\u0412 \u0438\u0441\u043f.1",
              "offer_id": "567543", "barcode": "OZN937869971", "price": 699, "commission_percent": 0.165,
              "price_sale": 653, "sale_qty": 1, "sale_amount": 653, "sale_discount": 0, "sale_commission": 69.34,
              "sale_price_seller": 583.66, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 10, "product_id": 493063052,
                                                                  "product_name": "\u0413\u043e\u043b\u043e\u0432\u043a\u0430 \u043f\u043e\u0436. \u0413\u041c-50",
                                                                  "offer_id": "342167", "barcode": "OZN937888294",
                                                                  "price": 299, "commission_percent": 0.18,
                                                                  "price_sale": 305, "sale_qty": 1, "sale_amount": 305,
                                                                  "sale_discount": 0, "sale_commission": 59.82,
                                                                  "sale_price_seller": 245.18, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 11, "product_id": 493063052,
              "product_name": "\u0413\u043e\u043b\u043e\u0432\u043a\u0430 \u043f\u043e\u0436. \u0413\u041c-50",
              "offer_id": "342167", "barcode": "OZN937888294", "price": 299, "commission_percent": 0.18,
              "price_sale": 299, "sale_qty": 1, "sale_amount": 299, "sale_discount": 0, "sale_commission": 53.82,
              "sale_price_seller": 245.18, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 12, "product_id": 493063048,
                                                                  "product_name": "\u0411\u0430\u0433\u043e\u0440 \u043f\u043e\u0436\u0430\u0440\u043d\u044b\u0439",
                                                                  "offer_id": "Bagorpojarn", "barcode": "OZN937927364",
                                                                  "price": 950, "commission_percent": 0.18,
                                                                  "price_sale": 736, "sale_qty": 1, "sale_amount": 736,
                                                                  "sale_discount": 43.12, "sale_commission": 0.12,
                                                                  "sale_price_seller": 779, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 13, "product_id": 493063048,
              "product_name": "\u0411\u0430\u0433\u043e\u0440 \u043f\u043e\u0436\u0430\u0440\u043d\u044b\u0439",
              "offer_id": "Bagorpojarn", "barcode": "OZN937927364", "price": 950, "commission_percent": 0.18,
              "price_sale": 772, "sale_qty": 1, "sale_amount": 772, "sale_discount": 7.12, "sale_commission": 0.12,
              "sale_price_seller": 779, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 14, "product_id": 493063048,
                                                                  "product_name": "\u0411\u0430\u0433\u043e\u0440 \u043f\u043e\u0436\u0430\u0440\u043d\u044b\u0439",
                                                                  "offer_id": "Bagorpojarn", "barcode": "OZN937927364",
                                                                  "price": 950, "commission_percent": 0.18,
                                                                  "price_sale": 706, "sale_qty": 7, "sale_amount": 4942,
                                                                  "sale_discount": 511.84, "sale_commission": 0.84,
                                                                  "sale_price_seller": 5453, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 15, "product_id": 493063048,
              "product_name": "\u0411\u0430\u0433\u043e\u0440 \u043f\u043e\u0436\u0430\u0440\u043d\u044b\u0439",
              "offer_id": "Bagorpojarn", "barcode": "OZN937927364", "price": 950, "commission_percent": 0.18,
              "price_sale": 766, "sale_qty": 1, "sale_amount": 766, "sale_discount": 13.12, "sale_commission": 0.12,
              "sale_price_seller": 779, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0},
             {"row_number": 16, "product_id": 493102099, "product_name": "\u041a\u0420\u0422\u043f-10",
              "offer_id": "KRTP10", "barcode": "OZN937950264", "price": 499, "commission_percent": 0.18,
              "price_sale": 517, "sale_qty": 2, "sale_amount": 1034, "sale_discount": 0, "sale_commission": 215.64,
              "sale_price_seller": 818.36, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0},
             {"row_number": 17, "product_id": 493102099, "product_name": "\u041a\u0420\u0422\u043f-10",
              "offer_id": "KRTP10", "barcode": "OZN937950264", "price": 499, "commission_percent": 0.18,
              "price_sale": 489, "sale_qty": 1, "sale_amount": 489, "sale_discount": 0, "sale_commission": 79.82,
              "sale_price_seller": 409.18, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 18, "product_id": 493063042,
                                                                  "product_name": "\u0412\u044d\u0440\u0441-\u041f\u041a-2\u041f",
                                                                  "offer_id": "Pk2p", "barcode": "OZN937973990",
                                                                  "price": 8031, "commission_percent": 0.18,
                                                                  "price_sale": 6146, "sale_qty": 1,
                                                                  "sale_amount": 6146, "sale_discount": 439.54,
                                                                  "sale_commission": 0.12, "sale_price_seller": 6585.42,
                                                                  "return_sale": 0, "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 19, "product_id": 493087545,
              "product_name": "\u0412\u0438\u0434\u0435\u043e\u043a\u0430\u043c\u0435\u0440\u0430 HiWatch DS-T204 (2.8)",
              "offer_id": "HiWatchDST204(2.8)", "barcode": "OZN956859683", "price": 3349, "commission_percent": 0.12,
              "price_sale": 2916, "sale_qty": 1, "sale_amount": 2916, "sale_discount": 31.24, "sale_commission": 0.12,
              "sale_price_seller": 2947.12, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 20, "product_id": 490790427,
                                                                  "product_name": "\u0418\u0437\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c \u043e\u0445\u0440\u0430\u043d\u043d\u044b\u0439 \u0418\u041e 102-26 \u0438\u0441\u043f.05 \"\u0410\u044f\u043a\u0441\"",
                                                                  "offer_id": "Io10226isp05Aysk",
                                                                  "barcode": "OZN958544414", "price": 959,
                                                                  "commission_percent": 0.165, "price_sale": 863,
                                                                  "sale_qty": 2, "sale_amount": 1726,
                                                                  "sale_discount": 0, "sale_commission": 124.48,
                                                                  "sale_price_seller": 1601.52, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 21, "product_id": 490790362,
              "product_name": "\u0418\u0437\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c \u043e\u0445\u0440\u0430\u043d\u043d\u044b\u0439 \u0418\u043e 102-5",
              "offer_id": "Io1025", "barcode": "OZN958685867", "price": 289, "commission_percent": 0.165,
              "price_sale": 295, "sale_qty": 10, "sale_amount": 2950, "sale_discount": 0, "sale_commission": 536.9,
              "sale_price_seller": 2413.1, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 22, "product_id": 490779407,
                                                                  "product_name": "\u0418\u0437\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c \u043e\u0445\u0440\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u0447\u0435\u0447\u043d\u044b\u0439 \u043c\u0430\u0433\u043d\u0438\u0442\u043e\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0439 \u0418\u043e 102-52",
                                                                  "offer_id": "IO10252", "barcode": "OZN958726005",
                                                                  "price": 300, "commission_percent": 0.165,
                                                                  "price_sale": 300, "sale_qty": 1, "sale_amount": 300,
                                                                  "sale_discount": 0, "sale_commission": 49.5,
                                                                  "sale_price_seller": 250.5, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 23, "product_id": 490779393,
              "product_name": "\u0418\u0437\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c \u043e\u0445\u0440\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u0447\u0435\u0447\u043d\u044b\u0439 \u043c\u0430\u0433\u043d\u0438\u0442\u043e\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0439 \u0418\u043e 102-555 \u041d\u0440+\u0422\u0448",
              "offer_id": "IO102555HPTSH", "barcode": "OZN958735676", "price": 339, "commission_percent": 0.165,
              "price_sale": 334, "sale_qty": 1, "sale_amount": 334, "sale_discount": 0, "sale_commission": 50.94,
              "sale_price_seller": 283.06, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 24, "product_id": 493037656,
                                                                  "product_name": "\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 CCU422-HOME/W/PC",
                                                                  "offer_id": "CCU422HOME", "barcode": "OZN958904932",
                                                                  "price": 10399, "commission_percent": 0.165,
                                                                  "price_sale": 8275, "sale_qty": 1,
                                                                  "sale_amount": 8275, "sale_discount": 408.28,
                                                                  "sale_commission": 0.12, "sale_price_seller": 8683.16,
                                                                  "return_sale": 0, "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 25, "product_id": 493037647,
              "product_name": "\u0423\u043d\u0438\u0432\u0435\u0440\u0441\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u0443\u0435\u043c\u044b\u0439 \u043f\u0443\u043b\u044c\u0442 Dublicator URC-4 V3.1",
              "offer_id": "DublicatorURC431", "barcode": "OZN958907861", "price": 1599, "commission_percent": 0.165,
              "price_sale": 1558, "sale_qty": 1, "sale_amount": 1558, "sale_discount": 0, "sale_commission": 222.84,
              "sale_price_seller": 1335.16, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 26, "product_id": 493051669,
                                                                  "product_name": "\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u0441\u0442\u0430\u0431\u0438\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0411\u041f \u0410\u0422-12/30",
                                                                  "offer_id": "34568", "barcode": "OZN963021582",
                                                                  "price": 1691, "commission_percent": 0.145,
                                                                  "price_sale": 1431, "sale_qty": 1,
                                                                  "sale_amount": 1431, "sale_discount": 14.92,
                                                                  "sale_commission": 0.12, "sale_price_seller": 1445.8,
                                                                  "return_sale": 0, "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 27, "product_id": 493051669,
              "product_name": "\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u0441\u0442\u0430\u0431\u0438\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0411\u041f \u0410\u0422-12/30",
              "offer_id": "34568", "barcode": "OZN963021582", "price": 1691, "commission_percent": 0.145,
              "price_sale": 1444, "sale_qty": 1, "sale_amount": 1444, "sale_discount": 1.92, "sale_commission": 0.12,
              "sale_price_seller": 1445.8, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 28, "product_id": 571150044,
                                                                  "product_name": "\u0422\u0440\u0435\u0432\u043e\u0436\u043d\u0430\u044f \u0440\u0430\u0434\u0438\u043e\u043a\u043d\u043e\u043f\u043a\u0430 RR-701t",
                                                                  "offer_id": "rr701t", "barcode": "OZN1076367725",
                                                                  "price": 4199, "commission_percent": 0.165,
                                                                  "price_sale": 3385, "sale_qty": 1,
                                                                  "sale_amount": 3385, "sale_discount": 121.28,
                                                                  "sale_commission": 0.12, "sale_price_seller": 3506.16,
                                                                  "return_sale": 0, "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 29, "product_id": 609508245,
              "product_name": "\u0412\u0438\u0434\u0435\u043e\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 HiWatch DS-H304Q",
              "offer_id": "artol304q", "barcode": "OZN1146234913", "price": 7599, "commission_percent": 0.165,
              "price_sale": 6516, "sale_qty": 1, "sale_amount": 6516, "sale_discount": 0, "sale_commission": 170.84,
              "sale_price_seller": 6345.16, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 30, "product_id": 610692964,
                                                                  "product_name": "\u0411\u043e\u043b\u0438\u0434 \u041a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440 SW8, \u0447\u0435\u0440\u043d\u044b\u0439",
                                                                  "offer_id": "artolsw", "barcode": "OZN1148356852",
                                                                  "price": 16200, "commission_percent": 0.145,
                                                                  "price_sale": 13014, "sale_qty": 1,
                                                                  "sale_amount": 13014, "sale_discount": 837.12,
                                                                  "sale_commission": 0.12, "sale_price_seller": 13851,
                                                                  "return_sale": 0, "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 31, "product_id": 611815203,
              "product_name": "RR-1R \u041f\u0440\u0438\u0435\u043c\u043d\u0438\u043a", "offer_id": "155454",
              "barcode": "OZN1150258536", "price": 3200, "commission_percent": 0.165, "price_sale": 2650, "sale_qty": 1,
              "sale_amount": 2650, "sale_discount": 22.12, "sale_commission": 0.12, "sale_price_seller": 2672,
              "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0, "return_commission": 0,
              "return_price_seller": 0},
             {"row_number": 32, "product_id": 612621225, "product_name": "iDo111 \u0431\u0440\u0435\u043b\u043e\u043a",
              "offer_id": "74123", "barcode": "OZN1151648092", "price": 489, "commission_percent": 0.165,
              "price_sale": 482, "sale_qty": 1, "sale_amount": 482, "sale_discount": 0, "sale_commission": 73.69,
              "sale_price_seller": 408.31, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 33, "product_id": 617612214,
                                                                  "product_name": "\u0412\u0438\u0434\u0435\u043e\u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435 HiWatch DS-I122 (4.0)",
                                                                  "offer_id": "122hw", "barcode": "OZN1160320626",
                                                                  "price": 6649, "commission_percent": 0.165,
                                                                  "price_sale": 5715, "sale_qty": 1,
                                                                  "sale_amount": 5715, "sale_discount": 0,
                                                                  "sale_commission": 163.09,
                                                                  "sale_price_seller": 5551.91, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 34, "product_id": 667698816,
              "product_name": "\u041c\u041f\u041d \u043c\u043e\u0434\u0443\u043b\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438",
              "offer_id": "Modyli5684", "barcode": "OZN1233310529", "price": 310, "commission_percent": 0.165,
              "price_sale": 304.64, "sale_qty": 3, "sale_amount": 913.92, "sale_discount": 0, "sale_commission": 137.37,
              "sale_price_seller": 776.55, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 35, "product_id": 667698816,
                                                                  "product_name": "\u041c\u041f\u041d \u043c\u043e\u0434\u0443\u043b\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438",
                                                                  "offer_id": "Modyli5684", "barcode": "OZN1233310529",
                                                                  "price": 288, "commission_percent": 0.165,
                                                                  "price_sale": 293, "sale_qty": 3, "sale_amount": 879,
                                                                  "sale_discount": 0, "sale_commission": 157.56,
                                                                  "sale_price_seller": 721.44, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 36, "product_id": 668791696,
              "product_name": "RVi \u041e\u0431\u044a\u0435\u043a\u0442\u0438\u0432 777654", "offer_id": "rvi0660a",
              "barcode": "OZN1234503442", "price": 1069, "commission_percent": 0.12, "price_sale": 979, "sale_qty": 1,
              "sale_amount": 979, "sale_discount": 0, "sale_commission": 38.28, "sale_price_seller": 940.72,
              "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0, "return_commission": 0,
              "return_price_seller": 0}, {"row_number": 37, "product_id": 651621554,
                                          "product_name": "\u041a\u0421-4 \u041a\u043e\u0440\u043e\u0431\u043a\u0430 \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0446\u0438\u043e\u043d\u043d\u0430\u044f",
                                          "offer_id": "Kc4", "barcode": "OZN1237486887", "price": 275,
                                          "commission_percent": 0.18, "price_sale": 275, "sale_qty": 3,
                                          "sale_amount": 825, "sale_discount": 0, "sale_commission": 148.5,
                                          "sale_price_seller": 676.5, "return_sale": 0, "return_qty": 0,
                                          "return_amount": 0, "return_discount": 0, "return_commission": 0,
                                          "return_price_seller": 0}, {"row_number": 38, "product_id": 651621554,
                                                                      "product_name": "\u041a\u0421-4 \u041a\u043e\u0440\u043e\u0431\u043a\u0430 \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0446\u0438\u043e\u043d\u043d\u0430\u044f",
                                                                      "offer_id": "Kc4", "barcode": "OZN1237486887",
                                                                      "price": 275, "commission_percent": 0.18,
                                                                      "price_sale": 321, "sale_qty": 3,
                                                                      "sale_amount": 963, "sale_discount": 0,
                                                                      "sale_commission": 286.5,
                                                                      "sale_price_seller": 676.5, "return_sale": 0,
                                                                      "return_qty": 0, "return_amount": 0,
                                                                      "return_discount": 0, "return_commission": 0,
                                                                      "return_price_seller": 0},
             {"row_number": 39, "product_id": 671195394,
              "product_name": "\u0412\u0438\u0434\u0435\u043e\u043a\u0430\u043c\u0435\u0440\u0430 ACE-S560CHP4 (4.3)",
              "offer_id": "artolace2", "barcode": "OZN1237532995", "price": 3999, "commission_percent": 0.165,
              "price_sale": 3251, "sale_qty": 1, "sale_amount": 3251, "sale_discount": 88.28, "sale_commission": 0.12,
              "sale_price_seller": 3339.16, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 40, "product_id": 696687913,
                                                                  "product_name": "\u041e\u043f\u043e\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c \u0413\u0440\u043e\u043c-12\u041a \u0438\u0441\u043f. 2",
                                                                  "offer_id": "uhrurhuh", "barcode": "OZN1263065162",
                                                                  "price": 999, "commission_percent": 0.165,
                                                                  "price_sale": 863, "sale_qty": 1, "sale_amount": 863,
                                                                  "sale_discount": 0, "sale_commission": 28.84,
                                                                  "sale_price_seller": 834.16, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 41, "product_id": 696820260,
              "product_name": "Etalon battery \u0410\u043a\u043a\u0443\u043c\u0443\u043b\u044f\u0442\u043e\u0440\u043d\u0430\u044f \u0431\u0430\u0442\u0430\u0440\u0435\u044f, 1 \u0448\u0442",
              "offer_id": "uksfhuhfs", "barcode": "OZN1263188791", "price": 935, "commission_percent": 0.175,
              "price_sale": 794, "sale_qty": 1, "sale_amount": 794, "sale_discount": 0, "sale_commission": 22.63,
              "sale_price_seller": 771.37, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 42, "product_id": 714756412,
                                                                  "product_name": "\u0411\u043e\u043b\u0438\u0434 \u0423\u041a-\u0412\u041a \u0438\u0441\u043f.13 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435",
                                                                  "offer_id": "dah12feuhf", "barcode": "OZN1279107393",
                                                                  "price": 1766, "commission_percent": 0.165,
                                                                  "price_sale": 1656, "sale_qty": 1,
                                                                  "sale_amount": 1656, "sale_discount": 0,
                                                                  "sale_commission": 181.39,
                                                                  "sale_price_seller": 1474.61, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 43, "product_id": 780566313,
              "product_name": "\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 RS-FX-SM40 \u0411\u043e\u043b\u0438\u0434",
              "offer_id": "fglmlkb269", "barcode": "", "price": 13580, "commission_percent": 0.115, "price_sale": 12443,
              "sale_qty": 1, "sale_amount": 12443, "sale_discount": 0, "sale_commission": 424.7,
              "sale_price_seller": 12018.3, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 44, "product_id": 780566313,
                                                                  "product_name": "\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 RS-FX-SM40 \u0411\u043e\u043b\u0438\u0434",
                                                                  "offer_id": "fglmlkb269", "barcode": "",
                                                                  "price": 13580, "commission_percent": 0.115,
                                                                  "price_sale": 12450, "sale_qty": 2,
                                                                  "sale_amount": 24900, "sale_discount": 0,
                                                                  "sale_commission": 863.4,
                                                                  "sale_price_seller": 24036.6, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 45, "product_id": 781563225,
              "product_name": "\u0411\u043b\u043e\u043a \u0438\u043d\u0434\u0438\u043a\u0430\u0446\u0438\u0438 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u04212000-\u041f\u0442 \u0411\u043e\u043b\u0438\u0434",
              "offer_id": "S2000PT", "barcode": "", "price": 11000, "commission_percent": 0.165, "price_sale": 9038,
              "sale_qty": 1, "sale_amount": 9038, "sale_discount": 147.12, "sale_commission": 0.12,
              "sale_price_seller": 9185, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 46, "product_id": 782169592,
                                                                  "product_name": "\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043e\u043a\u043e\u043d\u0435\u0447\u043d\u043e\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432\u043e\u0435 \u043f\u0440\u0438\u0435\u043c\u043d\u043e-\u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e\u0435 STEMAX sx810",
                                                                  "offer_id": "stemaxsx810", "barcode": "OZN1340872216",
                                                                  "price": 14999, "commission_percent": 0.165,
                                                                  "price_sale": 11946, "sale_qty": 1,
                                                                  "sale_amount": 11946, "sale_discount": 578.28,
                                                                  "sale_commission": 0.12,
                                                                  "sale_price_seller": 12524.16, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 47, "product_id": 782169592,
              "product_name": "\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043e\u043a\u043e\u043d\u0435\u0447\u043d\u043e\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432\u043e\u0435 \u043f\u0440\u0438\u0435\u043c\u043d\u043e-\u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e\u0435 STEMAX sx810",
              "offer_id": "stemaxsx810", "barcode": "OZN1340872216", "price": 9542, "commission_percent": 0.115,
              "price_sale": 8010, "sale_qty": 1, "sale_amount": 8010, "sale_discount": 434.79, "sale_commission": 0.12,
              "sale_price_seller": 8444.67, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 48, "product_id": 783811125,
                                                                  "product_name": "\u0422\u043e\u043f\u043e\u0440 \u043f\u043e\u0436\u0430\u0440\u043d\u044b\u0439",
                                                                  "offer_id": "rtui1qd", "barcode": "OZN1342394891",
                                                                  "price": 649, "commission_percent": 0.18,
                                                                  "price_sale": 526, "sale_qty": 3, "sale_amount": 1578,
                                                                  "sale_discount": 18.9, "sale_commission": 0.36,
                                                                  "sale_price_seller": 1596.54, "return_sale": 526,
                                                                  "return_qty": 3, "return_amount": 1578,
                                                                  "return_discount": 18.9, "return_commission": 0.36,
                                                                  "return_price_seller": 1596.54},
             {"row_number": 49, "product_id": 849742700,
              "product_name": "\u041a\u0430\u0440\u0442\u0430 \u043f\u0430\u043c\u044f\u0442\u0438",
              "offer_id": "microSD3292", "barcode": "OZN1400439457", "price": 658, "commission_percent": 0.155,
              "price_sale": 620, "sale_qty": 1, "sale_amount": 620, "sale_discount": 0, "sale_commission": 63.99,
              "sale_price_seller": 556.01, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0},
             {"row_number": 50, "product_id": 864539623, "product_name": "HiWatch DS-H308Q",
              "offer_id": "HiWatchDSH308Q", "barcode": "OZN1413361347", "price": 10700, "commission_percent": 0.12,
              "price_sale": 8605, "sale_qty": 1, "sale_amount": 8605, "sale_discount": 811.12, "sale_commission": 0.12,
              "sale_price_seller": 9416, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0},
             {"row_number": 51, "product_id": 864539623, "product_name": "HiWatch DS-H308Q",
              "offer_id": "HiWatchDSH308Q", "barcode": "OZN1413361347", "price": 10700, "commission_percent": 0.12,
              "price_sale": 8811, "sale_qty": 1, "sale_amount": 8811, "sale_discount": 605.12, "sale_commission": 0.12,
              "sale_price_seller": 9416, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 52, "product_id": 864826459,
                                                                  "product_name": "\u041a\u0430\u043d\u0438\u0444\u043e\u043b\u044c \u0441\u043e\u0441\u043d\u043e\u0432\u0430\u044f Fit, 20\u0433",
                                                                  "offer_id": "Kanifolisosnovaia",
                                                                  "barcode": "OZN1413568888", "price": 300,
                                                                  "commission_percent": 0.16, "price_sale": 300,
                                                                  "sale_qty": 2, "sale_amount": 600, "sale_discount": 0,
                                                                  "sale_commission": 96, "sale_price_seller": 504,
                                                                  "return_sale": 0, "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 53, "product_id": 867286971,
              "product_name": "\u0421\u0442\u0435\u043a\u043b\u043e\u0434\u043e\u043c\u043a\u0440\u0430\u0442 \u043e\u0434\u0438\u043d\u0430\u0440\u043d\u044b\u0439, \u043f\u043b\u0430\u0441\u0442\u0438\u043a\u043e\u0432\u044b\u0439",
              "offer_id": "SteklodomkratOdinarnuiPlastik", "barcode": "OZN1415800742", "price": 400,
              "commission_percent": 0.17, "price_sale": 404, "sale_qty": 1, "sale_amount": 404, "sale_discount": 0,
              "sale_commission": 72, "sale_price_seller": 332, "return_sale": 0, "return_qty": 0, "return_amount": 0,
              "return_discount": 0, "return_commission": 0, "return_price_seller": 0},
             {"row_number": 54, "product_id": 867359745,
              "product_name": "TR-500F \u0431\u0440\u0435\u043b\u043e\u043a \u043f\u0443\u043b\u044c\u0442 \u0434\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043a ACS-101, 102",
              "offer_id": "TR500FACS101102", "barcode": "OZN1415850010", "price": 1400, "commission_percent": 0.225,
              "price_sale": 1113, "sale_qty": 2, "sale_amount": 2226, "sale_discount": 0, "sale_commission": 56,
              "sale_price_seller": 2170, "return_sale": 1113, "return_qty": 1, "return_amount": 1113,
              "return_discount": 0, "return_commission": 28, "return_price_seller": 1085},
             {"row_number": 55, "product_id": 867359745,
              "product_name": "TR-500F \u0431\u0440\u0435\u043b\u043e\u043a \u043f\u0443\u043b\u044c\u0442 \u0434\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043a ACS-101, 102",
              "offer_id": "TR500FACS101102", "barcode": "OZN1415850010", "price": 1400, "commission_percent": 0.225,
              "price_sale": 1077, "sale_qty": 1, "sale_amount": 1077, "sale_discount": 8.12, "sale_commission": 0.12,
              "sale_price_seller": 1085, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 56, "product_id": 867359745,
                                                                  "product_name": "TR-500F \u0431\u0440\u0435\u043b\u043e\u043a \u043f\u0443\u043b\u044c\u0442 \u0434\u0438\u0441\u0442\u0430\u043d\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043a ACS-101, 102",
                                                                  "offer_id": "TR500FACS101102",
                                                                  "barcode": "OZN1415850010", "price": 1400,
                                                                  "commission_percent": 0.225, "price_sale": 1074,
                                                                  "sale_qty": 2, "sale_amount": 2148,
                                                                  "sale_discount": 22.24, "sale_commission": 0.24,
                                                                  "sale_price_seller": 2170, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0},
             {"row_number": 57, "product_id": 869197893,
              "product_name": "\u0418\u0437\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c \u043e\u0445\u0440\u0430\u043d\u043d\u044b\u0439 \u04212000-\u0421\u0422 \u0438\u0441\u043f.02",
              "offer_id": "004041", "barcode": "OZN1417419454", "price": 2200, "commission_percent": 0.165,
              "price_sale": 1968, "sale_qty": 17, "sale_amount": 33456, "sale_discount": 0, "sale_commission": 2227,
              "sale_price_seller": 31229, "return_sale": 0, "return_qty": 0, "return_amount": 0, "return_discount": 0,
              "return_commission": 0, "return_price_seller": 0}, {"row_number": 58, "product_id": 883312477,
                                                                  "product_name": "\u0418\u0437\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c \u043e\u0445\u0440\u0430\u043d\u043d\u044b\u0439 \u043c\u0430\u0433\u043d\u0438\u0442\u043e\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0439 \u0414\u041f\u041c-2 \u0438\u0441\u043f.00",
                                                                  "offer_id": "\u0414\u041f\u041c-2\u0438\u0441\u043f.00",
                                                                  "barcode": "OZN1430121862", "price": 1300,
                                                                  "commission_percent": 0.165, "price_sale": 1119.65,
                                                                  "sale_qty": 7, "sale_amount": 7837.55,
                                                                  "sale_discount": 0, "sale_commission": 239.05,
                                                                  "sale_price_seller": 7598.5, "return_sale": 0,
                                                                  "return_qty": 0, "return_amount": 0,
                                                                  "return_discount": 0, "return_commission": 0,
                                                                  "return_price_seller": 0}]}}

dt = pd.DataFrame(answer_oson.get('result').get('rows'))

# writer(answer_oson.get('result').get('rows'))
writer()
